machine:
  environment:
    DISPLAY: ":99.0"

dependencies:
  override:
    - sed -i '/source \/home\/ubuntu\/virtualenvs\//d' ~/.circlerc
    - sudo apt-get update -qq
    - sudo apt-get install -qq python-dogtail python-gi python3-dev python3-gi gir1.2-gtk-3.0 python-gi-cairo python3-gi-cairo gsettings-desktop-schemas python-pyatspi python-dbus at-spi2-core libatk-adaptor gnome-screenshot language-pack-gnome-en python3-setuptools libdbus-glib-1-dev glib2.0-dev gobject-introspection libgirepository1.0-dev python3-cairo-dev
    - sudo easy_install3 pip
    - sudo pip3 install -q pytest pytest-cov
    - sudo pip3 install -q coala --pre --upgrade

test:
  override:
    - export DISPLAY=:99.0
    - gsettings set org.gnome.desktop.interface toolkit-accessibility true
    - gsettings get org.gnome.desktop.interface toolkit-accessibility
    - python2 tests/gui/WindowTest.py
